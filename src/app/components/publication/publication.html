<div class="post-card" (click)="verDetalle(publicacion._id)">
  <img
    class="post-avatar"
    [src]="publicacion.usuario?.profileImage || 'https://i.pravatar.cc/48?img=65'"
    alt="avatar"
  />

  <div class="post-body">
    <div class="post-header">
      <strong>{{ publicacion.usuario?.username || 'Desconocido' }}</strong>
      <span class="post-meta">
        {{ publicacion.createdAt ? (publicacion.createdAt | date: 'short') : '' }}
      </span>

      <div class="post-options" (click)="toggleMenu($event); $event.stopPropagation()">
        â‹®
        <div class="options-menu" *ngIf="menuVisible">
          <button (click)="mostrarConfirm($event); $event.stopPropagation()"></button>
          <button *ngIf="!esMia()" (click)="agregarAmigo()">â• Agregar amigo</button>
        </div>
      </div>
    </div>

    <div *ngIf="esMia()" class="post-badge">Tu publicaciÃ³n</div>

    <div class="post-title" *ngIf="publicacion.titulo">
      <strong>{{ publicacion.titulo }}</strong>
    </div>
    <div class="post-content">{{ publicacion.texto }}</div>

    <img
      *ngIf="publicacion.imagenUrl"
      [src]="publicacion.imagenUrl"
      alt="Imagen publicaciÃ³n"
      class="post-image"
    />

    <div class="post-actions">
      <button
        class="btn like-btn"
        id="like-{{ publicacion._id }}"
        [class.liked]="publicacion.liked"
        (click)="publicacion.liked ? quitarLike() : darLike(); $event.stopPropagation()"
      >
        <span class="moon-icon">{{ publicacion.liked ? 'ğŸŒ™' : 'ğŸŒ‘' }}</span>
        <span *ngIf="likesCount() > 0">{{ likesCount() }}</span>
      </button>

      <app-comentarios
        [publicacionId]="publicacion._id"
        [usuarioActualId]="usuarioActualId"
        (click)="$event.stopPropagation()"
      ></app-comentarios>
    </div>

    <label *ngIf="errorMsg" class="error-msg">{{ errorMsg }}</label>
    <label *ngIf="successMsg" class="success-msg">{{ successMsg }}</label>
  </div>
</div>

<div class="modal-overlay" *ngIf="confirmVisible" (click)="cancelarEliminar()">
  <div class="confirm-modal" (click)="$event.stopPropagation()">
    <h3>Eliminar publicaciÃ³n</h3>
    <p>Â¿EstÃ¡s seguro que querÃ©s eliminar esta publicaciÃ³n? Esta acciÃ³n la ocultarÃ¡ para todos.</p>
    <div class="modal-actions">
      <button class="btn" (click)="cancelarEliminar()">Cancelar</button>
      <button class="btn danger" [disabled]="processing" (click)="confirmarEliminar()">Eliminar</button>
    </div>
  </div>
</div>
